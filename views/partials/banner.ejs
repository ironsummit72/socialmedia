<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>banner</title>
</head>
<body>
    <div class="flex flex-col border shadow-md w-full h-[65vh] z-20">
        <video id="banner" muted poster="/coverthumbnail/<%=coverthumbnail%>" style="object-position: <%=coverposition%>;" class="z-10 bg-cover bg-no-repeat object-cover object-[center]  h-full rounded-md" src="/covervideo/<%=covervideo%>"></video>
        <div class="pmenu-container">
            <img src="<%=displaypicture%>" id="displaypicture" alt="" class="profile w-64 h-64 absolute top-[65vh]  left-[10vw] object-fill rounded-full z-10">
            <div class="pmenu menu">
                <%if(ownprofile){%>
                    <a href="/create/story">Create Story</a>
                    <a href="/stories">View Story</a>
                <%}else{%>
                    <a href="/stories/<%=username%>">View Story</a>
                <%}%>
            </div>
        </div>
        <div class="  w-full h-[35.5vh] p-14 relative right-10  bottom-10 flex flex-col justify-between  ">
            <div class="title flex flex-col justify-between h-20">
                <h1 id="displayname" class="font-bold text-2xl relative left-20 "><%=firstname%>  <%=lastname%> <a href="/profile/<%=username%>"><span>@<%=username%></span></a></h1>
                <div class="followinfo">
                     <%if(ownprofile){%>
                        <a class="following" href="/following"><span class="relative left-20 font-bold text-red-500 "> <%=following.length%> following</span></a> 
                        <a class="followers" href="/followers"><span class="relative left-20 font-bold text-red-500 "><%=followers.length%> followers</span></a> 
                        <span class="relative left-20 font-bold "><%=posts.length%>posts</span>
                        <%}else{%>
                            <a class="following" href="/following/<%=username%>"><span class="relative left-20 font-bold text-red-500 "> <%=following.length%> following</span></a> 
                            <a class="followers" href="/followers/<%=username%>"><span class="relative left-20 font-bold text-red-500 "><%=followers.length%> followers</span></a> 
                            <span class="relative left-20 font-bold "><%=posts.length%>posts</span>
                    <% }%>
                

                </div>
            </div>
            <div class="discription relative left-56 h-24 flex flex-col justify-around ">
                <p class="text-black font-bold "><%=bio%></p>
                <div class="h-14 relative  top-5 flex">
                    <% if(ownprofile){%>
                        <a class="flex justify-center items-center text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700" href="/dp"> EditAvatar</a>
                        <a class= "flex justify-center items-center text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700" href="/create/post">Create Post</a>
                        <a class= "flex justify-center items-center text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700" href="/cover">Edit Cover and Bio</a>
                    <%} else{%>
                        <% let isFollowing=followers.some((filter)=> {
                            return filter.username === loggedInUser;
                            });
                            %>
                        
                            <% if(isFollowing) {%>
                                <button id="followunfollow" onclick="onClick('<%=username%>')" class="unfollow w-[60%] h-10 text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700">unfollow</button>
                                <%}else {%>
                                    <button id="followunfollow" onclick="onClick('<%=username%>')" class="follow w-[60%] h-10 text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">follow</button>
                           <%}%>
                 <%   }  %>
                </div>
            </div>
            <%- include('./profilenav'); -%>
        </div>
    </div>
</body>
<script src="/javascripts/updateFollow.js"></script>
<script src="/javascripts/isStoriesAvailable.js"></script>
<script src="/javascripts/bannerCover.js"></script>

</html>